<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org/">
<head th:replace="~{fragment::head}"></head>
<body>
<!--Main Top Header menu -->
<header th:replace="~{fragment::maintop}"></header>
<div th:replace="~{fragment::mobiletop}"></div>
<main class="main">
    <div class="page-header breadcrumb-wrap">
        <div class="container">
            <div class="breadcrumb">
                <a href="index.html" rel="nofollow">Home</a>
                <span></span> Pages
                <span></span> Account
            </div>
        </div>
    </div>
    <section class="pt-150 pb-150">
        <div class="container">
            <div class="row">
                <div class="col-lg-10 m-auto">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="dashboard-menu">
                                <ul class="nav flex-column" role="tablist">
                                    <li class="nav-item">
                                        <a class="nav-link active" id="dashboard-tab" data-bs-toggle="tab"
                                           href="#dashboard" role="tab" aria-controls="dashboard" aria-selected="false"><i
                                                class="fi-rs-settings-sliders mr-10"></i>Dashboard</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="orders-tab" data-bs-toggle="tab" href="#orders"
                                           role="tab" aria-controls="orders" aria-selected="false"><i
                                                class="fi-rs-shopping-bag mr-10"></i>Orders</a>
                                    </li>
<!--                                    <li class="nav-item">-->
<!--                                        <a class="nav-link" id="track-orders-tab" data-bs-toggle="tab"-->
<!--                                           href="#track-orders" role="tab" aria-controls="track-orders"-->
<!--                                           aria-selected="false"><i class="fi-rs-shopping-cart-check mr-10"></i>Track-->
<!--                                            Your Order</a>-->
<!--                                    </li>-->
                                    <li class="nav-item">
                                        <a class="nav-link" id="address-tab" data-bs-toggle="tab" href="#address"
                                           role="tab" aria-controls="address" aria-selected="true"><i
                                                class="fi-rs-marker mr-10"></i>My Address</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="account-detail-tab" data-bs-toggle="tab"
                                           href="#account-detail" role="tab" aria-controls="account-detail"
                                           aria-selected="true"><i class="fi-rs-user mr-10"></i>Account details</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" th:href="@{/logout}"><i class="fi-rs-sign-out mr-10"></i>Logout</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <div class="tab-content dashboard-content">
                                <div class="tab-pane fade active show" id="dashboard" role="tabpanel"
                                     aria-labelledby="dashboard-tab">
                                    <div class="card">
                                        <div class="card-header d-flex">
                                            <i class="fa-solid fa-circle-user fa-2xl my-auto mx-2"
                                               style="color: #7e8ca5;"></i>
                                            <h5 class="mb-0" th:text="${customer.firstName}"></h5>
                                        </div>
                                        <div class="card-body">
                                            <div>
                                                <strong>Full Name:</strong>
                                                <span th:text="${customer.firstName} + ' ' + ${customer.lastName}"></span>
                                            </div>
                                            <div>
                                                <strong>Mobile Number:</strong>
                                                <span th:text="${customer.phoneNumber}"></span>
                                            </div>
                                            <div>
                                                <strong>Email ID:</strong>
                                                <span th:text="${customer.username}"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!--Here added the track order/your order tab-->

                                <div class="tab-pane fade" id="orders" role="tabpanel" aria-labelledby="orders-tab">
                                    <div class="row">
                                        <div class="card-header">
                                            <h5 class="mb-0">Your Orders</h5>
                                        </div>
                                        <div class="orders" >

                                        </div>
                                    </div>
                                </div>

                                <div class="tab-pane fade" id="address" role="tabpanel" aria-labelledby="address-tab">
                                    <div th:if="${success}">
                                        <p class="alert alert-success" th:text="${success}"></p>
                                    </div>
<!--                                    <div th:if="${error}">-->
<!--                                        <p class="alert alert-danger" th:text="${error}"></p>-->
<!--                                    </div>-->
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="container">
                                                <header>
                                                    <strong class="fs-4 float-left">Address Book</strong>
                                                    <button type="button" class="btn btn-success float-end p-2"
                                                            id="addAddressModalBtn"
                                                            data-bs-toggle="modal" data-bs-target="#addAddressModal">Add
                                                        Address
                                                    </button>
                                                    <hr/>
                                                </header>
                                                <div class="row1">
                                                    <div class="col-lg-8 col-md-8">
                                                        <div class="card mb-3 mb-lg-0">
                                                            <div class="card-header">
                                                                <h5 class="mb-0">Billing Address</h5>
                                                            </div>
                                                            <div class="card-body">
                                                                <address th:if="${addressStat != null}" class="row" th:each="address : ${addressList}">
                                                                    <div class="address-entry" th:if="${address.enabled}==false">
                                                                        <p th:text="${address.address_line_1 + ', ' + address.address_line_2 + ', ' + address.city + ', ' + address.country + ', ' + address.pincode}"></p>
                                                                        <a th:href="@{/update-address/{id}(id= ${address.id})}"
                                                                           class="btn-small edit-btn">Edit</a>
                                                                        <a th:if="${address.is_default()} == true"
                                                                           th:href="@{/disable-address/{id}(id = ${address.id})}"
                                                                           onclick="if (!(confirm('Are you sure you want to Disable this Address?'))) return false">Disable</a>
                                                                        <a th:if="${address.is_default()} == false"
                                                                           th:href="@{/enable-address/{id}(id = ${address.id})}"
                                                                           onclick="if (!(confirm('Are you sure you want to Enable this Address?'))) return false">Enable</a>
                                                                        <a th:href="@{/delete-address/{id}(id = ${address.id})}"
                                                                           onclick="if (!(confirm('Are you sure you want to Delete this Address?'))) return false">Delete</a>
                                                                    </div>
                                                                </address>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- Edit Address Modal -->
                                                    <div class="modal fade" id="editAddressModal" tabindex="-1"
                                                         role="dialog" aria-labelledby="editAddressModalLabel"
                                                         aria-hidden="true">
                                                        <div class="modal-dialog" role="document">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="editAddressModalLabel">
                                                                        Edit Address</h5>
                                                                    <button type="button" class="close"
                                                                            data-dismiss="modal" aria-label="Close">
                                                                        <span aria-hidden="true">&times;</span>
                                                                    </button>
                                                                </div>
                                                                <div class="modal-body">
                                                                </div>
                                                                <!-- Edit address form currently the modal is disables due to some issue -->
                                                                <form th:action="@{/edit-address}" method="post"
                                                                      id="checkOut-form" class="mt-5">
                                                                    <div class="form-group">
                                                                        <label>Address Line 1 *</label>
                                                                        <input type="text" class="form-control"
                                                                               name="address_line_1" required
                                                                               id="address_line_1Edit">
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label>Address Line 2 *</label>
                                                                        <input type="text" class="form-control"
                                                                               name="address_line_2" required
                                                                               id="address_line_2Edit">
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label>Town / City *</label>
                                                                        <input type="text" class="form-control"
                                                                               name="city" required id="cityEdit">
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label>Country *</label>
                                                                        <input type="text" class="form-control"
                                                                               name="country" required id="countryEdit">
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label>Postcode / ZIP *</label>
                                                                        <input type="number" class="form-control"
                                                                               name="pinCode" required id="pinCodeEdit">
                                                                    </div>
                                                                    <input type="hidden" name="id" id="idEdit">
                                                                    <div class="modal-footer">
                                                                        <button type="button" class="btn btn-secondary"
                                                                                data-dismiss="modal">Close
                                                                        </button>
                                                                        <button type="submit" class="btn btn-primary">
                                                                            Save changes
                                                                        </button>
                                                                    </div>
                                                                </form>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Add Address Modal -->
                                                <div class="modal fade" id="addAddressModal" tabindex="-1"
                                                     role="dialog" aria-labelledby="addAddressModalLabel"
                                                     aria-hidden="true">
                                                    <div class="modal-dialog" role="document">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="addAddressModalLabel">
                                                                    Add Address</h5>
                                                                <button type="button" class="close"
                                                                        data-bs-dismiss="modal" aria-label="Close">
                                                                    <span aria-hidden="true">&times;</span>
                                                                </button>
                                                            </div>
                                                            <div class="modal-body">
                                                                <div th:if = "${success}">
                                                                    <p class = "alert alert-success" th:text = "${success}"></p>
                                                                </div>
                                                                <div th:if = "${error}">
                                                                    <p class = "alert alert-danger" th:text = "${error}"></p>
                                                                </div>
                                                                <!-- Add address form -->
                                                                <form id="addressForm" method="post"
                                                                      th:object="${addressDto}"
                                                                      th:action="@{/add-address}">
                                                                    <div class="form-group">
                                                                        <label>Address Line 1<span
                                                                                class="required">*</span></label>
                                                                        <input id="address_line_1"
                                                                               class="form-control square"
                                                                               name="address_line_1" type="text"
                                                                               th:field="*{address_line_1}">
                                                                        <div class="error text-danger ms-2"></div>
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label>Address Line 2<span
                                                                                class="required">*</span></label>
                                                                        <input id="address_line_2"
                                                                               class="form-control square"
                                                                               name="address_line_2" type="text"
                                                                               th:field="*{address_line_2}">
                                                                        <div class="error text-danger ms-2"></div>
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label>Town / City *</label>
                                                                        <input id="city" type="text" name="town"
                                                                               class="form-control"
                                                                               th:field="*{city}">
                                                                        <div class="error text-danger ms-2"></div>
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label>country *</label>
                                                                        <input id="country" type="text" name="country"
                                                                               class="form-control"
                                                                               th:field="*{country}">
                                                                        <div class="error text-danger ms-2"></div>
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label>Postcode / ZIP *</label>
                                                                        <input id="pincode" type="number" name="pincode"
                                                                               class="form-control"
                                                                               th:field="*{pincode}">
                                                                        <div class="error text-danger ms-2"></div>
                                                                    </div>
                                                                    <div class="modal-footer">
                                                                        <button type="button"
                                                                                class="btn btn-secondary"
                                                                                data-bs-dismiss="modal">Close
                                                                        </button>
                                                                        <button type="submit"
                                                                                class="btn btn-primary">Save
                                                                        </button>
                                                                    </div>
                                                                </form>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                        <div class="tab-pane fade" id="account-detail" role="tabpanel"
                             aria-labelledby="account-detail-tab">
                            <div th:if="${success}" class="text-center alert alert-success">
                                <p th:text="${success}"></p>
                            </div>
                            <div class="card">
                                <div class="card-header">
                                    <h5>Account Details</h5>
                                </div>
                                <div class="card-body">
                                    <form th:action="@{/update-profile}"
                                          id="accountForm" th:object="${customer}"
                                          method="post">
                                        <div class="row">
                                            <div class="form-group col-md-6">
                                                <label>First Name <span class="required">*</span></label>
                                                <input required="" class="form-control square" name="name" type="text"
                                                       id="firstName" th:field="*{firstName}">
                                                <div class="error text-danger"></div>
                                            </div>
                                            <div class="alert alert-warning"
                                                 th:if="${#fields.hasErrors('firstName')}"
                                                 th:errors="*{firstName}"></div>
                                            <div class="form-group col-md-6">
                                                <label>Last Name <span class="required">*</span></label>
                                                <input required="" class="form-control square" name="lastname"
                                                       type="text" th:field="*{lastName}" id="lastName">
                                                <div class="error text-danger"></div>
                                            </div>
                                            <div class="alert alert-warning"
                                                 th:if="${#fields.hasErrors('lastName')}"
                                                 th:errors="*{lastName}" required></div>
                                            <div class="form-group col-md-12">
                                                <label>Phone Number <span class="required">*</span></label>
                                                <input required="" class="form-control square" type="number"
                                                       th:field="*{phoneNumber}"
                                                       th:placeholder="${customer.phoneNumber != null} ? ${customer.phoneNumber} : 'Enter your phone number'"
                                                       id="phoneNumber" name="phoneNumber" maxlength="12"
                                                       minlength="10">
                                                <div class="error text-danger"></div>
                                            </div>
                                            <div class="form-group col-md-12">
                                                <label>Email Address <span class="required">*</span></label>
                                                <input required="" class="form-control square" name="email" type="email"
                                                       th:field="*{username}"
                                                       th:placeholder="${customer.username != null} ? ${customer.username} : 'Enter your email'"
                                                       id="email" readonly>
                                            </div>
                                            <div class="button-separator "></div>
                                            <!-- Separation -->
                                            <!-- Password Change Modal -->

                                            <button type="button"
                                                    class="btn btn-fill-out-transparent  change-password"
                                                    data-bs-toggle="modal"
                                                    data-bs-target="#changePasswordModal">Change
                                                Password
                                            </button>
                                            <div class="button-padding  mt-3"></div>
                                            <!-- Padding -->
                                            <button type="submit" class="btn btn-fill-out submit"
                                                    name="submit"
                                                    value="Submit">Save
                                            </button>
                                        </div>
                                    </form>
                                    <div class="modal fade" id="changePasswordModal" tabindex="-1"
                                         role="dialog" aria-labelledby="changePasswordModalLabel"
                                         aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title"
                                                        id="changePasswordModalLabel">Change
                                                        Password</h5>
                                                    <button type="button" class="close"
                                                            data-bs-dismiss="modal"
                                                            aria-label="Close">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <!-- Password change form goes here -->
                                                    <form id="passwordChangeForm"
                                                          th:action="@{/change-password}"
                                                          method="post">
                                                        <!-- Include your password change fields here -->
<!--                                                        <h5 class="formTitle">-->
<!--                                                            <i>Change Password</i>-->
<!--                                                        </h5>-->
                                                        <div th:if="${message}" class="text-center alert">
                                                            <p th:text="${message}"></p>
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="oldPassword">Current
                                                                Password</label>
                                                            <input type="password"
                                                                   class="form-control"
                                                                   id="oldPassword"
                                                                   name="oldPassword">
                                                            <div class="invalid-feedback">Please
                                                                enter your current password.
                                                            </div>
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="newPassword">New
                                                                Password</label>
                                                            <input type="password"
                                                                   class="form-control"
                                                                   id="newPassword"
                                                                   name="newPassword">
                                                            <div class="invalid-feedback">Please
                                                                enter a new password.
                                                            </div>
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="repeatNewPassword">Confirm
                                                                Password</label>
                                                            <input type="password"
                                                                   class="form-control"
                                                                   id="repeatNewPassword"
                                                                   name="repeatNewPassword">
                                                            <div class="invalid-feedback">Please
                                                                confirm your new password.
                                                            </div>
                                                        </div>
                                                        <div class="modal-footer">
                                                            <button type="button"
                                                                    class="btn btn-secondary"
                                                                    data-bs-dismiss="modal">Close
                                                            </button>
                                                            <button type="submit"
                                                                    class="btn btn-primary"
                                                                    id="savePasswordChanges"
                                                                    disabled>Save Changes
                                                            </button>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>

<footer th:replace="~{fragment::downbar}"></footer>
<!-- Preloader Start -->
<div id="preloader-active">
    <div class="preloader d-flex align-items-center justify-content-center">
        <div class="preloader-inner position-relative">
            <div class="text-center">
                <h5 class="mb-5">Now Loading</h5>
                <div class="loader">
                    <div class="bar bar1"></div>
                    <div class="bar bar2"></div>
                    <div class="bar bar3"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<div th:if="${success}" class="text-center alert"
     style="background-color: #00b09b; color: #fff; padding: 10px; border-radius: 8px; margin: 10px auto; max-width: 200px;">
    <p th:text="${success}"></p>
    <script>
        setTimeout(function () {
            document.querySelector('.alert').style.display = 'none';
        }, 3000); // Hide the message after 3 seconds (adjust as needed)
    </script>
</div>
<div th:if="${error}" class="text-center alert"
     style="background-color: #ff0000; color: #fff; padding: 10px; border-radius: 8px; margin: 10px auto; max-width: 200px;">
    <p th:text="${error}"></p>
    <script>
        setTimeout(function () {
            document.querySelector('.alert').style.display = 'none';
        }, 3000); // Hide the message after 3 seconds (adjust as needed)
    </script>
</div>

<!-- Modal showing script -->
<script>
    $(document).ready(function () {
        $("#changePasswordButton").click(function () {
            $("#changePasswordModal").modal("show");
        });

        // Handle the "Save Changes" button click inside the modal
        $("#savePasswordChanges").click(function () {
            // Perform password change logic here
            // You can use AJAX to send the updated password to your server
            // Close the modal when the changes are saved
            $("#changePasswordModal").modal("hide");
        });
    });

<!-- Password changing script -->

    document.getElementById("passwordChangeForm").addEventListener("input", function () {
        // Check if all input fields have values
        const oldPassword = document.getElementById("oldPassword").value;
        const newPassword = document.getElementById("newPassword").value;
        const repeatNewPassword = document.getElementById("repeatNewPassword").value;

        // Enable or disable the save button based on validation
        const saveButton = document.getElementById("savePasswordChanges");
        if (oldPassword && newPassword && repeatNewPassword && newPassword === repeatNewPassword) {
            saveButton.removeAttribute("disabled");
        } else {
            saveButton.setAttribute("disabled", "disabled");
        }
    });

<!-- Include jQuery and Bootstrap JS files replace jqueri if you need -->

<!--Controlling current Tab -->

    $(document).ready(function () {
        const openTabValue = "[[${openTab}]]";
        const errorMessage = "[[${message}]]";

        console.log(openTabValue)

        if (openTabValue != "") {
            $('.nav a[href="#' + openTabValue + '"]').tab('show');
            document.getElementById(openTabValue + "-tab").click();
        }
        if (errorMessage) {
            alert(errorMessage);
        }
    });
</script>
<script th:src="@{/js/tab.js}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/js/jquery.dataTables.min.js" integrity="sha512-BkpSL20WETFylMrcirBahHfSnY++H2O1W+UnEEO4yNIl+jI2+zowyoGJpbtk6bx97fBXf++WJHSSK2MV4ghPcg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/js/dataTables.bootstrap4.min.js" integrity="sha512-OQlawZneA7zzfI6B1n1tjUuo3C5mtYuAWpQdg+iI9mkDoo7iFzTqnQHf+K5ThOWNJ9AbXL4+ZDwH7ykySPQc+A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.5.0/dist/js/bootstrap.bundle.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script th:src="@{/js/account.js}"></script>
<script th:src="@{/js/address.js}"></script>
<script th:src="@{/js/vendor/modernizr-3.6.0.min.js}"></script>
<script th:src="@{/js/vendor/jquery-3.6.0.min.js}"></script>
<script th:src="@{/js/vendor/jquery-migrate-3.3.0.min.js}"></script>
<script th:src="@{/js/vendor/bootstrap.bundle.min.js}"></script>
<script th:src="@{/js/plugins/slick.js}"></script>
<script th:src="@{/js/plugins/jquery.syotimer.min.js}"></script>
<script th:src="@{/js/plugins/wow.js}"></script>
<script th:src="@{/js/plugins/jquery-ui.js}"></script>
<script th:src="@{/js/plugins/perfect-scrollbar.js}"></script>
<script th:src="@{/js/plugins/magnific-popup.js}"></script>
<script th:src="@{/js/plugins/select2.min.js}"></script>
<script th:src="@{/js/plugins/waypoints.js}"></script>
<script th:src="@{/js/plugins/counterup.js}"></script>
<script th:src="@{/js/plugins/jquery.countdown.min.js}"></script>
<script th:src="@{/js/plugins/images-loaded.js}"></script>
<script th:src="@{/js/plugins/isotope.js}"></script>
<script th:src="@{/js/plugins/scrollup.js}"></script>
<script th:src="@{/js/plugins/jquery.vticker-min.js}"></script>
<script th:src="@{/js/plugins/jquery.theia.sticky.js}"></script>
<!-- Template  JS -->
<script th:src="@{/js/main.js?v=3.4}"></script>
<script th:src="@{/js/shop.js?v=3.4}"></script>
</body>
</html>